# yaml-language-server: $schema=https://kubernetes-schemas.devbu.io/helm.toolkit.fluxcd.io/helmrelease_v2beta1.json
apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: authelia
spec:
  chart:
    spec:
      chart: authelia
      version: "0.9.16"
      sourceRef:
        kind: HelmRepository
        name: authelia
        namespace: flux-system
  values: 
    ingress:
      enabled: true
      annotations: {}
    configMap:
      theme: dark
      storage:
        encryption_key:
          secret_name: encryption-key
          path: encryption_key
        postgres:
          enabled: true
          address: "tcp://authelia-postgres-rw.authelia.svc.cluster.local:5432"
          database: app
          username: app
          password:
            secret_name: database-password
            path: database_password
      session:
        name: authelia_infra_session
        cookies:
        - subdomain: auth
          domain: infra.k8s.ashman.world
        redis:
          enabled: true
          host: authelia-dragonfly.authelia.svc.cluster.local
          port: 6379
      tls:
        enabled: true


