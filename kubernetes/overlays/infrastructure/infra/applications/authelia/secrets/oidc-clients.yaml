
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: oidc-clients
spec:
  refreshInterval: 15s
  secretStoreRef:
    kind: ClusterSecretStore
    name: vault-backend
  target:
    name: oidc-clients
    template:
      engineVersion: v2
      templateFrom:
        - configMap:
            name: oidc-config
            items:
              - key: configuration.oidc.yaml
  data:
  - secretKey: minio_password_hash
    remoteRef:
      key: k8s/oauth/authelia/clients/minio
      property: hash
  - secretKey: kubelogin_password_hash
    remoteRef:
      key: k8s/oauth/authelia/clients/kubelogin
      property: hash
  - secretKey: kasm_password_hash
    remoteRef:
      key: k8s/oauth/authelia/clients/kasm
      property: hash
  - secretKey: gitlab_password_hash
    remoteRef:
      key: k8s/oauth/authelia/clients/gitlab
      property: hash
  - secretKey: config_jwks_key
    remoteRef:
      key: k8s/oauth/authelia/config
      property: jwks_key
  - secretKey: config_hmac_secret
    remoteRef:
      key: k8s/oauth/authelia/config
      property: hmac_secret
