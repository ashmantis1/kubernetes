# Ansible local host runner
- name: Run Terraform
  ansible.builtin.import_playbook: ./ansible/playbooks/create_infrastructure.yaml
  tags: always
- name: Configure Nodes
  ansible.builtin.import_playbook: ./ansible/playbooks/configure_nodes.yaml
  tags: configure
# - name: Configure workers
#   ansible.builtin.import_playbook: ./ansible/playbooks/configure_workers.yaml
#   tags: configure
- name: Deploy k8s bootstrap 
  ansible.builtin.import_playbook: ./ansible/playbooks/deploy_bootstrap.yaml
  tags: k8s
- name: Deploy k8s control plane
  ansible.builtin.import_playbook: ./ansible/playbooks/deploy_masters.yaml
  tags: k8s,masters
- name: Deploy k8s workers
  ansible.builtin.import_playbook: ./ansible/playbooks/deploy_workers.yaml
  tags: k8s,workers
- name: Setup cluster (cilium, etc.)
  ansible.builtin.import_playbook: ./ansible/playbooks/setup_cluster.yaml
  tags: setup
- name: Destroy cluster
  ansible.builtin.import_playbook: ./ansible/playbooks/destroy_cluster.yaml
  tags: never,destroy_cluster